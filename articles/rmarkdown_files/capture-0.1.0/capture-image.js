(()=>{var e={162:function(e,t,n){var o;void 0===(o=function(){"use strict";function t(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){c(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,s=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,n,s){var c=i.URL||i.webkitURL,a=document.createElement("a");n=n||e.name||"download",a.download=n,a.rel="noopener","string"==typeof e?(a.href=e,a.origin===location.origin?r(a):o(a.href)?t(e,n,s):r(a,a.target="_blank")):(a.href=c.createObjectURL(e),setTimeout((function(){c.revokeObjectURL(a.href)}),4e4),setTimeout((function(){r(a)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,i){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,i),n);else if(o(e))t(e,n,i);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){r(s)}))}}:function(e,n,o,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,o);var c="application/octet-stream"===e.type,a=/constructor/i.test(i.HTMLElement)||i.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||c&&a||s)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var e=l.result;e=u?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},l.readAsDataURL(e)}else{var h=i.URL||i.webkitURL,f=h.createObjectURL(e);r?r.location=f:location.href=f,r=null,setTimeout((function(){h.revokeObjectURL(f)}),4e4)}});i.saveAs=c.saveAs=c,e.exports=c}.apply(t,[]))||(e.exports=o)}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";var e=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};const t="application/font-woff",o="image/jpeg",r={woff:t,woff2:t,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:o,jpeg:o,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"};function i(e){const t=function(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}(e).toLowerCase();return r[t]||""}function s(e){return-1!==e.search(/^(data:)/)}function c(e,t){return`data:${t};base64,${e}`}const a=function(){let e=0;return()=>(e+=1,`u${`0000${(Math.random()*Math.pow(36,4)<<0).toString(36)}`.slice(-4)}${e}`)}();function u(e){const t=[];for(let n=0,o=e.length;n<o;n+=1)t.push(e[n]);return t}function l(e,t){const n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}function h(e){return e.toBlob?new Promise((t=>e.toBlob(t))):new Promise((t=>{const n=window.atob(e.toDataURL().split(",")[1]),o=n.length,r=new Uint8Array(o);for(let e=0;e<o;e+=1)r[e]=n.charCodeAt(e);t(new Blob([r],{type:"image/png"}))}))}function f(e){return new Promise(((t,n)=>{const o=new Image;o.onload=()=>t(o),o.onerror=n,o.crossOrigin="anonymous",o.decoding="sync",o.src=e}))}const d={};function p(e,t){const n=function(e){let t=e.replace(/\?.*/,"");return/ttf|otf|eot|woff2?/i.test(t)&&(t=t.replace(/.*\//,"")),t}(e);if(null!=d[n])return d[n];t.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime());const o=window.fetch(e).then((e=>e.blob().then((t=>({blob:t,contentType:e.headers.get("Content-Type")||""}))))).then((({blob:e,contentType:t})=>new Promise(((n,o)=>{const r=new FileReader;r.onloadend=()=>n({contentType:t,blob:r.result}),r.onerror=o,r.readAsDataURL(e)})))).then((({blob:e,contentType:t})=>{return{contentType:t,blob:(n=e,n.split(/,/)[1])};var n})).catch((n=>{let o="";if(t.imagePlaceholder){const e=t.imagePlaceholder.split(/,/);e&&e[1]&&(o=e[1])}let r=`Failed to fetch resource: ${e}`;return n&&(r="string"==typeof n?n:n.message),r&&console.error(r),{blob:o,contentType:""}}));return d[n]=o,o}function v(e,t,n){const o=window.getComputedStyle(e,n),r=o.getPropertyValue("content");if(""===r||"none"===r)return;const i=a();try{t.className=`${t.className} ${i}`}catch(e){return}const s=document.createElement("style");s.appendChild(function(e,t,n){const o=`.${e}:${t}`,r=n.cssText?function(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}(n):function(e){return u(e).map((t=>`${t}: ${e.getPropertyValue(t)}${e.getPropertyPriority(t)?" !important":""};`)).join(" ")}(n);return document.createTextNode(`${o}{${r}}`)}(i,n,o)),t.appendChild(s)}var g=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};function m(e,t,n){return g(this,void 0,void 0,(function*(){return n||!t.filter||t.filter(e)?Promise.resolve(e).then((e=>function(e,t){return g(this,void 0,void 0,(function*(){return e instanceof HTMLCanvasElement?function(e){return g(this,void 0,void 0,(function*(){const t=e.toDataURL();return"data:,"===t?Promise.resolve(e.cloneNode(!1)):f(t)}))}(e):e instanceof HTMLVideoElement&&e.poster?function(e,t){return g(this,void 0,void 0,(function*(){return Promise.resolve(e.poster).then((e=>p(e,t))).then((t=>c(t.blob,i(e.poster)||t.contentType))).then((e=>f(e)))}))}(e,t):Promise.resolve(e.cloneNode(!1))}))}(e,t))).then((n=>function(e,t,n){var o;return g(this,void 0,void 0,(function*(){const r=null!=(i=e).tagName&&"SLOT"===i.tagName.toUpperCase()&&e.assignedNodes?u(e.assignedNodes()):u((null!==(o=e.shadowRoot)&&void 0!==o?o:e).childNodes);var i;return 0===r.length||e instanceof HTMLVideoElement?Promise.resolve(t):r.reduce(((e,o)=>e.then((()=>m(o,n))).then((e=>{e&&t.appendChild(e)}))),Promise.resolve()).then((()=>t))}))}(e,n,t))).then((t=>function(e,t){return g(this,void 0,void 0,(function*(){return t instanceof Element?Promise.resolve().then((()=>function(e,t){const n=window.getComputedStyle(e),o=t.style;o&&(n.cssText?o.cssText=n.cssText:u(n).forEach((e=>{o.setProperty(e,n.getPropertyValue(e),n.getPropertyPriority(e))})))}(e,t))).then((()=>function(e,t){v(e,t,":before"),v(e,t,":after")}(e,t))).then((()=>function(e,t){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}(e,t))).then((()=>t)):Promise.resolve(t)}))}(e,t))):Promise.resolve(null)}))}const w=/url\((['"]?)([^'"]+?)\1\)/g,y=/url\([^)]+\)\s*format\((["'])([^"']+)\1\)/g,b=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function x(e){const t=[];return e.replace(w,((e,n,o)=>(t.push(o),e))),t.filter((e=>!s(e)))}function P(e){return-1!==e.search(w)}function E(e,t,n){return o=this,r=void 0,a=function*(){if(!P(e))return Promise.resolve(e);const o=function(e,{preferredFontFormat:t}){return t?e.replace(b,(e=>{for(;;){const[n,,o]=y.exec(e)||[];if(!o)return"";if(o===t)return`src: ${n};`}})):e}(e,n);return Promise.resolve(o).then(x).then((e=>e.reduce(((e,o)=>e.then((e=>function(e,t,n,o,r){const s=n?function(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const n=document.implementation.createHTMLDocument(),o=n.createElement("base"),r=n.createElement("a");return n.head.appendChild(o),n.body.appendChild(r),t&&(o.href=t),r.href=e,r.href}(t,n):t;return Promise.resolve(s).then((e=>r?r(e):p(e,o))).then((e=>"string"==typeof e?c(e,i(t)):c(e.blob,i(t)||e.contentType))).then((n=>e.replace(function(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}(t),`$1${n}$3`))).then((e=>e),(()=>s))}(e,o,t,n)))),Promise.resolve(o))))},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{c(a.next(e))}catch(e){t(e)}}function i(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof s?o:new s((function(e){e(o)}))).then(n,i)}c((a=a.apply(o,r||[])).next())}));var o,r,s,a}var S=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};function T(e,t){return S(this,void 0,void 0,(function*(){return e instanceof Element?Promise.resolve(e).then((e=>function(e,t){var n;return S(this,void 0,void 0,(function*(){const o=null===(n=e.style)||void 0===n?void 0:n.getPropertyValue("background");return o?Promise.resolve(o).then((e=>E(e,null,t))).then((t=>(e.style.setProperty("background",t,e.style.getPropertyPriority("background")),e))):Promise.resolve(e)}))}(e,t))).then((e=>function(e,t){return S(this,void 0,void 0,(function*(){if((!(e instanceof HTMLImageElement)||s(e.src))&&(!(e instanceof SVGImageElement)||s(e.href.baseVal)))return Promise.resolve(e);const n=e instanceof HTMLImageElement?e.src:e.href.baseVal;return Promise.resolve(n).then((e=>p(e,t))).then((e=>c(e.blob,i(n)||e.contentType))).then((t=>new Promise(((n,o)=>{e.onload=n,e.onerror=o,e instanceof HTMLImageElement?(e.srcset="",e.src=t):e.href.baseVal=t})))).then((()=>e),(()=>e))}))}(e,t))).then((e=>function(e,t){return S(this,void 0,void 0,(function*(){const n=u(e.childNodes).map((e=>T(e,t)));return Promise.all(n).then((()=>e))}))}(e,t))):Promise.resolve(e)}))}var R=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};const L={};function $(e){const t=L[e];if(null!=t)return t;const n=window.fetch(e).then((t=>({url:e,cssText:t.text()})));return L[e]=n,n}function A(e){return R(this,void 0,void 0,(function*(){return e.cssText.then((t=>{let n=t;const o=/url\(["']?([^"')]+)["']?\)/g,r=(n.match(/url\([^)]+\)/g)||[]).map((t=>{let r=t.replace(o,"$1");return r.startsWith("https://")||(r=new URL(r,e.url).href),window.fetch(r).then((e=>e.blob())).then((e=>new Promise(((o,r)=>{const i=new FileReader;i.onloadend=()=>{n=n.replace(t,`url(${i.result})`),o([t,i.result])},i.onerror=r,i.readAsDataURL(e)}))))}));return Promise.all(r).then((()=>n))}))}))}function C(e){if(null==e)return[];const t=[];let n=e.replace(/(\/\*[\s\S]*?\*\/)/gi,"");const o=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const e=o.exec(n);if(null===e)break;t.push(e[0])}n=n.replace(o,"");const r=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let e=r.exec(n);if(null===e){if(e=i.exec(n),null===e)break;r.lastIndex=i.lastIndex}else i.lastIndex=r.lastIndex;t.push(e[0])}return t}function N(e){return e.filter((e=>e.type===CSSRule.FONT_FACE_RULE)).filter((e=>P(e.style.getPropertyValue("src"))))}function k(e,t){return R(this,void 0,void 0,(function*(){return(null!=t.fontEmbedCSS?Promise.resolve(t.fontEmbedCSS):function(e,t){return R(this,void 0,void 0,(function*(){return function(e){return R(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{null==e.ownerDocument&&n(new Error("Provided element is not within a Document")),t(u(e.ownerDocument.styleSheets))})).then((e=>function(e){return R(this,void 0,void 0,(function*(){const t=[],n=[];return e.forEach((t=>{if("cssRules"in t)try{u(t.cssRules).forEach(((e,o)=>{if(e.type===CSSRule.IMPORT_RULE){let r=o+1;const i=$(e.href).then((e=>e?A(e):"")).then((e=>C(e).forEach((e=>{try{t.insertRule(e,e.startsWith("@import")?r+=1:t.cssRules.length)}catch(t){console.error("Error inserting rule from remote css",{rule:e,error:t})}})))).catch((e=>{console.error("Error loading remote css",e.toString())}));n.push(i)}}))}catch(o){const r=e.find((e=>null==e.href))||document.styleSheets[0];null!=t.href&&n.push($(t.href).then((e=>e?A(e):"")).then((e=>C(e).forEach((e=>{r.insertRule(e,t.cssRules.length)})))).catch((e=>{console.error("Error loading remote stylesheet",e.toString())}))),console.error("Error inlining remote css file",o.toString())}})),Promise.all(n).then((()=>(e.forEach((e=>{if("cssRules"in e)try{u(e.cssRules).forEach((e=>{t.push(e)}))}catch(t){console.error(`Error while reading CSS rules from ${e.href}`,t.toString())}})),t)))}))}(e))).then(N)}))}(e).then((e=>Promise.all(e.map((e=>{const n=e.parentStyleSheet?e.parentStyleSheet.href:null;return E(e.cssText,n,t)}))))).then((e=>e.join("\n")))}))}(e,t)).then((t=>{const n=document.createElement("style"),o=document.createTextNode(t);return n.appendChild(o),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n),e}))}))}var M=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};function j(e,t={}){const n=t.width||function(e){const t=l(e,"border-left-width"),n=l(e,"border-right-width");return e.clientWidth+t+n}(e),o=t.height||function(e){const t=l(e,"border-top-width"),n=l(e,"border-bottom-width");return e.clientHeight+t+n}(e);return{width:n,height:o}}function U(t,n={}){return M(this,void 0,void 0,(function*(){const{width:o,height:r}=j(t,n);return Promise.resolve(t).then((e=>m(e,n,!0))).then((e=>k(e,n))).then((e=>T(e,n))).then((e=>function(e,t){const{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);const o=t.style;return null!=o&&Object.keys(o).forEach((e=>{n[e]=o[e]})),e}(e,n))).then((t=>function(t,n,o){return e(this,void 0,void 0,(function*(){const r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),s=document.createElementNS(r,"foreignObject");return i.setAttribute("width",`${n}`),i.setAttribute("height",`${o}`),i.setAttribute("viewBox",`0 0 ${n} ${o}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("externalResourcesRequired","true"),i.appendChild(s),s.appendChild(t),function(t){return e(this,void 0,void 0,(function*(){return Promise.resolve().then((()=>(new XMLSerializer).serializeToString(t))).then(encodeURIComponent).then((e=>`data:image/svg+xml;charset=utf-8,${e}`))}))}(i)}))}(t,o,r)))}))}const H=16384;var I=n(162);function O(e,t){return!(void 0===e.classList||!e.classList.contains(t))||e.parentNode&&O(e.parentNode,t)}function V(e,t){return void 0!==e.classList&&e.classList.contains(t)?e:V(e.parentNode,t)}!function(){function e(e){var t=e.target;if(O(t,"btn-capture-screenshot")){t=V(t,"btn-capture-screenshot");var n=window.navigator.userAgent;if(n.indexOf("MSIE ")>0||n.match(/Trident.*rv\:11\./))alert("Screenshot functionnality is not available with Internet Explorer.");else{t.classList.add("disabled");var o=t.getAttribute("data-selector"),r=document.querySelector(o),i=t.getAttribute("data-filename"),s=t.getAttribute("data-inputId"),c=parseInt(t.getAttribute("data-scale")),a=t.getAttribute("data-options");a=JSON.parse(a),isNaN(c)||(a.height=a.height?a.height*c:r.offsetHeight*c,a.width=a.width?a.width*c:r.offsetWidth*c,a.hasOwnProperty("style")||(a.style={}),a.style.transform="scale("+c+")",a.style.transformOrigin="top left",a.style.width=r.offsetWidth+"px",a.style.height=r.offsetHeight+"px"),function(e,t={}){return M(this,void 0,void 0,(function*(){return function(e,t={}){return M(this,void 0,void 0,(function*(){return U(e,t).then(f).then((n=>{const o=document.createElement("canvas"),r=o.getContext("2d"),i=t.pixelRatio||function(){let e,t;try{t=process}catch(e){}const n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}(),{width:s,height:c}=j(e,t),a=t.canvasWidth||s,u=t.canvasHeight||c;return o.width=a*i,o.height=u*i,t.skipAutoScale||function(e){(e.width>H||e.height>H)&&(e.width>H&&e.height>H?e.width>e.height?(e.height*=H/e.width,e.width=H):(e.width*=H/e.height,e.height=H):e.width>H?(e.height*=H/e.width,e.width=H):(e.width*=H/e.height,e.height=H))}(o),o.style.width=`${a}`,o.style.height=`${u}`,t.backgroundColor&&(r.fillStyle=t.backgroundColor,r.fillRect(0,0,o.width,o.height)),r.drawImage(n,0,0,o.width,o.height),o}))}))}(e,t).then(h)}))}(r,a).then((function(e){if(null!==i&&(0,I.saveAs)(e,i),null!==s){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){var e=n.result;Shiny.setInputValue(s,e)}}t.classList.remove("disabled")})).catch((function(e){console.error("Capture: oops, something went wrong!",e)}))}}}document.addEventListener("click",(function(t){try{e(t)}catch(e){console.error(e)}}))}()})()})();
//# sourceMappingURL=capture-image.js.map